<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta charset="UTF-8">
    <title>诚品宝</title>
    <link href="../css/check_app.css" rel="stylesheet">
</head>
<body>
<div class="circle">
    <a id="go" class="blink" href="#" style="display: none;">点击屏幕继续</a>
</div>
</body>
<script language="JavaScript" src="../scripts/js/jquery-3.1.0.min.js"></script>
<script>
var APPCommon = {
    u : navigator.userAgent,
    androidIntent: 'intent://splash/#Intent;scheme=cundong;package=com.cheng315.nfc;category=android.intent.category.DEFAULT;' +
        'action=android.intent.action.VIEW;S.browser_fallback_url=http%3A%2F%2Fm.315cheng.com%2Fpages%2Fdownload_app.html;end',
    downAppUrl: '/pages/download_app.html',
    openApp : function() {
        var _this = this;
        //微信或非android设备
        if(this.isWeixin() || _this.u.indexOf('Android') < 0) {
            window.location = this.downAppUrl;
            return;
        }

        /*1.先判断uc 360
         2.判断chrome
         3.判断非chrome*/

        if(_this.u.indexOf("UCBrowser") >= 0 || _this.u.indexOf("360") >= 0
                || _this.u.indexOf("QQ") >= 0 || _this.u.indexOf("Chrome") < 0) {
             var iframe = _this.createIframe();
             iframe.src = 'cundong://splash';
        } else if(_this.u.indexOf("Chrome") >= 0 && _this.u.indexOf("Safari") >= 0) {
            $('#go').show();
            $('#go').attr('href', _this.androidIntent);
            $('.circle').css('height', window.screen.availHeight);
            $('.circle').on('click', function () {
                window.location.href = _this.androidIntent;
            });
            return;
        }

        setTimeout(function () {
            window.location = _this.downAppUrl;
        }, 500);

    },
    isWeixin: function(){ //判断是否是微信
        var ua = this.u.toLowerCase();
        if (ua.match(/MicroMessenger/i) == "micromessenger") {
            return true;
        } else {
            return false;
        }
    },
    createIframe : function() {
        var iframe;
        return function(){
            if(iframe){
                return iframe;
            }else{
                iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                document.body.appendChild(iframe);
                return iframe;
            }
        }
    }
};

$(function () {
    APPCommon.openApp();
});

function check() {
    //判断 浏览器 类型
    var ex = navigator.userAgent,
            bUA;
    if (ex.indexOf("MSIE") >= 0) {
        bUA = "Internet Explorer 10  Or Earlier"; //IE
    } else if (ex.indexOf("Firefox") >= 0) {
        bUA = "Firefox";
    } else if (ex.indexOf("Chrome") >= 0) {
        bUA = "Chrome";
        if (ex.indexOf("360SE") >= 0) { //360安全浏览器
            bUA = "360SE";
        } else if (ex.indexOf("360EE") >= 0) { //360急速浏览器
            bUA = "360EE";
        } else if (ex.indexOf("SE") >= 0 && ex.indexOf("360SE") == -1) { //搜狗浏览器
            bUA = "SouGou";
        } else if (ex.indexOf("Maxthon") >= 0) { //遨游浏览器
            bUA = "Maxthon";
        }
    } else if (ex.indexOf("UCBrowser") >= 0 || ex.indexOf("UCWEB") >= 0) { // UC浏览器
        bUA = "UCBrowser";
    } else if (ex.indexOf("Opera") >= 0) {
        bUA = "Opera";
    } else if (ex.indexOf("Safari") >= 0) { // 苹果浏览器
        bUA = "Safari";
    } else if (ex.indexOf("Netscape") >= 0) {
        bUA = "Netscape";
    } else if (ex.indexOf("like Gecko") >= 0 && ex.indexOf("Trident") >= 0) {
        bUA = "Internet Explorer 11 Or Later"; //IE11 以后，不再用 MSIE
    } else {
        bUA = "Other Broswer";
    }
    return bUA;
}

</script>
</html>